---
- name: Клонирование репозитория tmux
  git:
    repo: https://github.com/tmux/tmux.git
    dest: "{{ ansible_env.HOME }}/libs/tmux"
    update: no 
  register: git_clone

- name: Переход в каталог tmux
  command: cd "{{ ansible_env.HOME }}/libs/tmux"
  args:
    chdir: "{{ ansible_env.HOME }}/libs/tmux"
  when: git_clone.changed

- name: Выполнение скрипта autogen.sh
  shell: sh autogen.sh
  args:
    chdir: "{{ ansible_env.HOME }}/libs/tmux"
  when: git_clone.changed

- name: Конфигурация и сборка tmux
  shell: ./configure --prefix="{{ ansible_env.HOME }}/libs/tmux" && make && make install
  args:
    chdir: "{{ ansible_env.HOME }}/libs/tmux"
  when: git_clone.changed
